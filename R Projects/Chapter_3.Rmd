---
title: "Chapter_3"
author: "Zoe"
date: "2025-09-10"
output: html_document
---

### Getting Graphic

------------------------------------------------------------------------

#### Histograms

```{r}
library(datasets)
```

```{r}
head(airquality)
```

```{r}
hist(airquality$Temp)
```

```{r}
hist(airquality$Temp,xlab="Temperature (Degrees
Fahrenheit)",main="Temperatures in New York City May 1 - September 30, 1973")
```

#### Density plots

```{r}
hist(
  airquality$Temp,
  xlab = "Temperature (Degrees Fahrenheit)",
  main = "Temperatures in New York City May 1 - September 30, 1973",
  probability = TRUE
)

lines(density(airquality$Temp), col = "blue", lwd = 2)
```

#### Bar plots

```{r}
library(MASS)
```

```{r}
head(Cars93[1:3])
```

```{r}
table(Cars93$Type)
```

```{r}
barplot(table(Cars93$Type))
```

```{r}
barplot(table(Cars93$Type),ylim=c(0,25),xlab="Type", ylab="Frequency", axis.lty="solid",space=.5)
```

```{r}
library(dplyr)
```

```{r}
USA.Cars93 <- filter(Cars93,Origin == "USA")
```

#### Grouping the bars

```{r}
females <- HairEyeColor[,,2]
```

```{r}
females
```

```{r}
color.names = c("black","grey40","grey80","white")
```

```{r}
t(females)
```

```{r}
par(mar=c(5,4,4,7)); barplot(t(females),beside=T,ylim=c(0,70),xlab="Hair Color",ylab="Frequency of Eye Color", col=color.names,axis.lty="solid"); legend("topright", rownames(t(females)), cex=0.8, fill=color.names, title="Eye Color", inset=c(-0.25,0), xpd=TRUE)
```

#### Quick Suggested Project

```{r}
males <- HairEyeColor[,,1]
```

```{r}
males
```

```{r}
color.names <- c("black", "grey40", "grey80", "white")
```

```{r}
t(males)
```

```{r}
par(mar = c(5, 4, 4, 7)); bar_midpoints <- barplot(t(males), beside = TRUE, ylim = c(0, 70), xlab = "Hair Color", ylab = "Frequency of Eye Color", col = color.names, axis.lty = "solid"); legend("topright", legend = rownames(t(males)), cex = 0.8, fill = color.names, title = "Eye Color", inset = c(-0.25, 0), xpd = TRUE)
```

#### LEGENDARY COLORS

```{r}
color.names <- c("saddlebrown",  # Brown eyes
                 "deepskyblue",  # Blue eyes
                 "goldenrod",    # Hazel eyes
                 "forestgreen")  # Green eyes
```

```{r}
brown.colors <- colors()[grep("brown", colors())]
```

```{r}
brown.colors
```

```{r}
blue.colors <- colors()[grep("blue", colors())]
```

```{r}
blue.colors
```

```{r}
hazel.colors <- colors()[grep("tan|gold|khaki|wheat|burlywood", colors())]
```

```{r}
hazel.colors
```

```{r}
green.colors <- colors()[grep("green", colors())]
```

```{r}
green.colors
```

#### QUICK SUGGESTED PROJECT: GROUPING REVISITED

```{r}
# Subset Cars93 to just Type and Origin
Type.Origin <- subset(Cars93, select = c(Type, Origin))
```

```{r}
head(Type.Origin)
```

```{r}
tbl <- table(Type.Origin$Type, Type.Origin$Origin)
```

```{r}
tbl
```

```{r}
mat <- t(tbl)
```

```{r}
cols_map <- c("USA" = "black", "non-USA" = "white")
```

```{r}
cols <- cols_map[rownames(mat)]
```

```{r}
par(mar = c(5,4,4,7)); bar_mid <- barplot(mat, beside = TRUE, col = cols, border = "black", ylim = c(0, max(mat) + 5), xlab = "Type", ylab = "Frequency", main = "Car Types by Origin"); legend("topright", legend = rownames(mat), fill = cols, border = "black", title = "Origin", inset = c(-0.25, 0), xpd = TRUE)

```

#### Pie graphs

```{r}
pie(table(Cars93$Type))
```

#### Scatterplots

```{r}
plot(airquality$Wind,airquality$Temp, pch=16,xlab = "Wind Velocity (MPH)", ylab ="Temperature (Fahrenheit)", main = "Temperature vs Wind Velocity")
```

```{r}
plot(airquality$Temp ~ airquality$Wind, pch=16,xlab = "Wind Velocity
(MPH)",ylab ="Temperature (Fahrenheit)", main = "Temperature vs Wind
Velocity")
```

#### Scatterplot matrix

```{r}
Ozone.Temp.Wind <- subset(airquality,select = c(Ozone,Temp,Wind))
```

```{r}
head(Ozone.Temp.Wind)
```

```{r}
pairs(Ozone.Temp.Wind)
```

#### Box plots

```{r}
boxplot(Temp ~ Month, data=airquality, xaxt = "n")
```

```{r}
boxplot(Temp ~ Month, data=airquality, xaxt = "n"); axis(1, at=1:5,labels=c("May","June","July","August", "September"))
```

#### Graduating to ggplot2

```{r}
library(ggplot2)
```

#### How it works

```{r}
ggplot(airquality, aes(x=Temp))
```

```{r}
ggplot(airquality, aes(x=Temp)) +
  geom_histogram()
```

##### `ggplot(data_source, aes(map data components to graph     components)) +`

##### `geom_xxx(arguments to modify the appearance of the geom) +`

##### `theme_xxx(arguments to change the overall appearance) +`

##### `labs(add axis-labels and a title)`

#### Histograms

```{r}
ggplot(airquality,aes(x=Temp)) +
  geom_histogram(binwidth = 5,color = "black",fill="grey80") + 
  theme_bw() +
  labs(x = "Temperature (Fahrenheit)",y="Frequency", title= "Temperatures in the airquality Data Frame")
```

#### Bar Plots

```{r}
ggplot(Cars93,aes(x=Type)) + 
  geom_bar()+ 
  labs(y="Frequency",title="Car Type and Frequency in Cars93")
```

#### Grouped bar plots

```{r}
Type.Origin <- subset(Cars93,select=c("Type","Origin"))
```

```{r}
head(Type.Origin)
```

```{r}
ggplot(Type.Origin,aes(x=Type,fill=Origin)) + 
  geom_bar(position="dodge",color="black") +
  scale_fill_grey(start=0,end=1)
```

```{r}
females
```

```{r}
females.df <- data.frame(females);
females.df
```

```{r}
ggplot(females.df, aes(x=Hair,y = Freq, fill=Eye))+
  geom_bar(position="dodge",color="black",stat="identity") + 
    scale_fill_grey(start=0,end=1)
```

#### SUGGESTED PROJECT: GROUPING ONE MORE TIME

```{r}
data("LifeCycleSavings")
```

```{r}
library(tibble)
```

```{r}
df <- head(LifeCycleSavings) %>%
  select(pop15, pop75) %>%
  rownames_to_column("Country")
```

```{r}
df
```

```{r}
library(tidyr)
```

```{r}
df_long <- df %>%
  gather(key = "AgeGroup", value = "Percent", pop15, pop75)
```

```{r}
df_long
```

```{r}
ggplot(df_long, aes(x = Country, y = Percent, fill = AgeGroup)) +
  geom_bar(stat = "identity", position = "dodge", color = "black") +
  scale_fill_grey(start = 0, end = 1, labels = c("Under 15", "Over 75")) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Scatterplots

```{r}
ggplot(airquality, aes(x=Wind,y=Temp))+
  geom_point()
```

#### The plot thickens . . .

```{r}
aq.no.NA <- drop_na(airquality)
```

```{r}
median.Ozone <- median(aq.no.NA$Ozone)
```

```{r}
Ozone_Level <- NULL
```

```{r}
for(i in 1:nrow(aq.no.NA)){
  if (aq.no.NA$Ozone[i] <= median.Ozone){
    Ozone_Level[i] <- "Low"}
    else{Ozone_Level[i] <- "High"}
}
```

```{r}
aq.Ozone.Level <- cbind(aq.no.NA, Ozone_Level)
```

```{r}
head(aq.Ozone.Level)
```

```{r}
ggplot(aq.Ozone.Level, aes(x=Wind,y=Temp,color=Ozone_Level))+
  geom_point(size=3)+
  scale_color_grey(start=0,end=1)
```

#### TEMPERATURE, WIND, AND OZONE

```{r}
aq.analysis <- lm(Temp ~ Wind + Ozone, data= aq.Ozone.Level)
```

```{r}
summary(aq.analysis)
```

```{r}
library(scatterplot3d)
```

```{r}
with(aq.Ozone.Level,
(scatterplot3d(Wind ~ Temp + Ozone, pch = 19)))
```

#### Scatterplot matrix

```{r}
aq.subset <- subset(aq.no.NA,select = c(Ozone,Wind,Temp,Solar.R))
```

```{r}
library(GGally)
```

```{r}
ggpairs(aq.subset, progress = FALSE)
```

#### Box plots

```{r}
ggplot(airquality, aes(x=as.factor(Month),y=Temp))+
  geom_boxplot()
```

```{r}
ggplot(airquality, aes(x=as.factor(Month),y=Temp)) +
  geom_boxplot()+
  geom_point()+
  labs(y="Temperature",x="Month")+
  scale_x_discrete(labels=c("May","June","July","August", "September"))
```

```{r}
library(MASS)
```

```{r}
data("anorexia")
head(anorexia)
```

```{r}
ggplot(anorexia, aes(x = Treat, y = Prewt)) +
  geom_boxplot() +
  geom_point() +
  labs(
    y = "Preweight (lbs)",
    x = "Treatment"
  ) +
  scale_x_discrete(labels = c("Cognitive Behavioral Therapy", "Control", "Family Therapy"))
```

```{r}
ggplot(anorexia, aes(x = Treat, y = Postwt)) +
  geom_boxplot() +
  geom_point() +
  labs(
    y = "Postweight (lbs)",
    x = "Treatment"
  ) +
  scale_x_discrete(labels = c("Cognitive Behavioral Therapy", "Control", "Family Therapy"))
```
